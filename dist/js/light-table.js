class LightTable{constructor(n){var t={selector:"table",stickyHead:!1,search:!1,pagination:!1,paginationPerPage:10,theme:"black",print:!1,exportCSV:!1,exportCSVFileName:"",charts:[],labels:{print:"Print",exportCSV:"Export CSV",searchAnyThing:"Search any thing"}},t=(t.exportCSVFileName="light table export "+(new Date).toDateString(),this.options={...t,...n},this.labels=this.options.labels,document.querySelectorAll(this.options.selector));0!=t.length&&t.forEach(t=>{var e=Math.floor(1e3*Math.random())+1+(Math.floor(100*Math.random())+1);let a=document.createElement("div");a.setAttribute("data-id","lt-table-"+e),a.setAttribute("data-pagination",this.options.pagination?"yes":"no"),a.setAttribute("data-pagination_items",this.options.paginationPerPage),a.setAttribute("data-sort",0),a.setAttribute("data-sort_type",1),t.parentNode.insertBefore(a,t),a.classList.add("lt-table"),a.classList.add("lt-"+this.options.theme);var r=document.createElement("div"),l=(r.classList.add("lt-table-header"),a.appendChild(r),document.createElement("div")),l=(l.classList.add("lt-table-table"),l.innerHTML=t.outerHTML,a.appendChild(l),document.createElement("div")),i=(l.classList.add("lt-table-footer"),a.appendChild(l),document.createElement("div")),e=(i.classList.add("lt-table-charts"),a.appendChild(i),t.setAttribute("data-id","lt-table-"+e),t.style.display="none",t.setAttribute("id","lt-table-hidden-"+e),this.options.stickyHead&&a.classList.add("lt-sticky"),this.options.search&&(i=Math.floor(1e3*Math.random())+1,(t=document.createElement("div")).classList.add("lt-table-search"),t.innerHTML='<label for="lt-table-search'+i+'">'+this.labels.searchAnyThing+':</label><input type="text" id="lt-table-search'+i+'" name="lt-table-search'+i+'" />',r.appendChild(t),a.querySelectorAll(".lt-table-search input").forEach(t=>{t.addEventListener("input",LightTable.#inputChanged)})),document.createElement("div"));e.classList.add("lt-table-actions"),r.appendChild(e),this.options.print&&LightTable.#print(e,this.labels),this.options.exportCSV&&LightTable.#exportCSV(e,this.labels,this.options),this.options.pagination&&((i=document.createElement("div")).classList.add("lt-table-pagination"),i.innerHTML="",l.appendChild(i),LightTable.#reloadData(a,1)),a.querySelectorAll('th[data-sortable="yes"]').forEach(t=>{t.addEventListener("click",function(t){var e=t.target.parentElement.parentElement.parentElement.parentElement.parentElement,t=t.target,t=[...t.parentNode.children].indexOf(t),t=(e.setAttribute("data-sort",t),1===parseInt(e.dataset.sort_type)?2:1);e.setAttribute("data-sort_type",t),LightTable.#reloadData(e,1)})}),0<n.charts.length&&n.charts.forEach(t=>{LightTable.#loadChart(a,t)})})}static#exportCSV(t,e,c){var a=document.createElement("button");a.classList.add("lt-table-actions-exportcsv"),a.innerHTML="<span>"+e.exportCSV+"</span>",t.appendChild(a),a.addEventListener("click",function(t){for(var e=t.target.parentElement.parentElement.parentElement.parentElement,t=(t.target,e.querySelectorAll("table")[0]),a=e.querySelectorAll(".lt-table-toggle-pagination.current")[0].dataset.page,r=(LightTable.#doSearch(e),[]),l=t.querySelectorAll("tr"),i=0;i<l.length;i++){for(var n=l[i].querySelectorAll("td,th"),s=[],o=0;o<n.length;o++)s.push(n[o].innerHTML);r.push(s.join(","))}var r=r.join("\n"),t=new Blob([r],{type:"text/csv"}),d=document.createElement("a"),t=(d.download=c.exportCSVFileName+".csv",window.URL.createObjectURL(t));d.href=t,d.style.display="none",document.body.appendChild(d),d.click(),document.body.removeChild(d),LightTable.#doSort(e),LightTable.#goToPage(e,a)})}static#print(t,e){var a=document.createElement("button");a.classList.add("lt-table-actions-print"),a.innerHTML="<span>"+e.print+"</span>",t.appendChild(a),a.addEventListener("click",function(t){var e=t.target.parentElement.parentElement.parentElement.parentElement.parentElement,t=(t.target,e.querySelectorAll("table")[0]),e=window.open("","PRINT","height=1000,width=1200");e.document.write("<html><head><title>"+document.title+"</title>"),e.document.write("</head><body >");return e.document.write("<style>table{ border-collapse: collapse; }table th,table td {padding:5px; border: 1px solid #000;} table tbody *{ color: #000; } </style>"),e.document.write("<h1>"+document.title+"</h1>"),e.document.write(t.outerHTML),e.document.write("</body></html>"),e.document.close(),e.focus(),e.print(),!0})}static#reloadData(t,e){LightTable.#buildPagination(t),LightTable.#doSearch(t),LightTable.#doSort(t),LightTable.#goToPage(t,1)}static#doSort(t){let l=parseInt(t.dataset.sort);var e=parseInt(t.dataset.sort_type),t=t.querySelectorAll("table")[0];let a=[];const i=t.querySelectorAll("tbody tr");i.forEach(t=>{t=t.querySelectorAll("td:nth-child("+(l+1)+")")[0].textContent;a.push(t)}),a.every(function(t){return/^-?\d+$/.test(t)})?a.sort(function(t,e){return t-e}):a.sort(),2===e&&a.reverse(),(a=new Set(a)).forEach(r=>{i.forEach(t=>{var e,a=t.parentElement;t.querySelectorAll("td:nth-child("+(l+1)+")")[0].textContent===r&&((e=document.createElement("tr")).innerHTML=t.innerHTML,t.remove(),a.insertBefore(e,a.firstElementChild))})})}static#inputChanged(t){t=t.target.parentElement.parentElement.parentElement;LightTable.#reloadData(t,1)}static#goToPage(t,e){t.dataset.id;var a=parseInt(t.dataset.pagination_items),r=document.querySelectorAll('.lt-table[data-id="'+t.dataset.id+'"] table')[0];document.querySelectorAll('table[data-id="'+t.dataset.id+'"]')[0],r.querySelectorAll("tbody")[0];let l=(e-=1)*a+1,i=l+a,n=0;t.querySelectorAll("table tbody tr").forEach(t=>{(++n<l||n>=i)&&t.remove()}),t.querySelectorAll(".lt-table-pagination button").forEach(t=>{t.classList.remove("current")}),t.querySelectorAll('.lt-table-pagination button[data-page="'+(e+1)+'"]')[0].classList.add("current")}static#buildPagination(t){t.dataset.id;var e=t.querySelectorAll(".lt-table-pagination")[0],a=document.querySelectorAll('.lt-table[data-id="'+t.dataset.id+'"] table')[0],r=t.dataset.pagination_items,t=(LightTable.#doSearch(t),a.querySelectorAll("tbody tr").length),l=Math.ceil(t/r);let i="";for(let t=1;t<=l;t++)i+='<button data-page="'+t+'" class="'+(1==t?"current":"")+' lt-table-toggle-pagination">'+t+"</button>";e.innerHTML=i;for(var n=e.querySelectorAll("button"),s=0;s<n.length;s++)n[s].addEventListener("click",function(t){var e=this.parentElement.parentElement.parentElement,a=this.dataset.page;LightTable.#doSearch(e),LightTable.#doSort(e),LightTable.#goToPage(e,a)},!1)}static#doSearch(t){t.dataset.id;var e=document.querySelectorAll('.lt-table[data-id="'+t.dataset.id+'"] table')[0],r=document.querySelectorAll('table[data-id="'+t.dataset.id+'"]')[0],e=e.querySelectorAll("tbody")[0];let l="";var a=t.querySelectorAll(".lt-table-search input").length;if(0==(l=0<a?t.querySelectorAll(".lt-table-search input")[0].value.toLowerCase():l).length)e.innerHTML=r.querySelectorAll("tbody")[0].outerHTML;else{let a=e.innerHTML="";r.querySelectorAll("tbody tr").forEach(t=>{let e="";t.querySelectorAll("td:not(.lt-exclude-search)").forEach(t=>{e+=" "+t.textContent.toLowerCase()}),e.includes(l)&&(a+=t.outerHTML)}),e.innerHTML=a}}static#loadChart(t,e){var a="lt-table-charts-"+(Math.floor(1e3*Math.random())+1),r=t.querySelectorAll(".lt-table-charts")[0],l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("id",a),r.appendChild(l);const i=[t,e,a];switch(e.id){case"bars":LightTable.#loadChartBars(i),window.addEventListener("resize",function(){LightTable.#loadChartBars(i)});break;case"line":LightTable.#loadChartLine(i),window.addEventListener("resize",function(){LightTable.#loadChartLine(i)})}}static#loadChartBars(t){var e=t[0];let r=t[1];var t=t[2],l=document.getElementById(t);if(l){t=document.querySelectorAll('table[data-id="'+e.dataset.id+'"]')[0].querySelectorAll("tbody tr");l.innerHTML="";let a=[];if(t.forEach((t,e)=>{console.log(t.querySelectorAll("td")[r.x]),void 0!==t.querySelectorAll("td")[r.x]&&void 0!==t.querySelectorAll("td")[r.y]&&(t={label:t.querySelectorAll("td")[r.x].textContent,value:t.querySelectorAll("td")[r.y].textContent},a.push(t))}),0==a.length)console.warn("data not found in table!");else{var e=a.map(function(t){return t.value}),i=Math.max(...e),n=r.hideAxis?l.clientWidth:l.clientWidth-60,s=r.hideAxis?l.clientHeight:l.clientHeight-60,o=(n-r.spacing*(a.length-1))/a.length,d=s/i;if(r.horizintalLines)for(let t=1;t<=i;t+=Math.round(i/r.axisScaleUnit)){var c=document.createElementNS("http://www.w3.org/2000/svg","line");c.setAttribute("transform","translate(30 30)"),c.setAttribute("x1",0),c.setAttribute("y1",s-t*d),c.setAttribute("x2",n),c.setAttribute("y2",s-t*d),c.setAttribute("stroke",r.horizintalLinesColors),c.setAttribute("stroke-width","1"),l.appendChild(c)}var u=document.createElementNS("http://www.w3.org/2000/svg","g");u.classList.add("lt-chart-visual"),r.hideAxis?u.setAttribute("transform","translate(0 0)"):u.setAttribute("transform","translate(30 30)"),u.setAttribute("width",n),u.setAttribute("height",s),l.appendChild(u);for(let t=0;t<a.length;t++){var h=document.createElementNS("http://www.w3.org/2000/svg","g"),b=(h.classList.add("lt-chart-item"),u.appendChild(h),a[t].value),p=b*d,A=o,g=t*(A+r.spacing),m=s-p,w=document.createElementNS("http://www.w3.org/2000/svg","rect");w.setAttribute("x",g),w.setAttribute("y",m),w.setAttribute("width",A),w.setAttribute("height",p),w.setAttribute("fill",r.color),h.appendChild(w),r.hover&&((w=document.createElementNS("http://www.w3.org/2000/svg","text")).classList.add("lt-chart-hover"),w.setAttribute("x",g+A/2),w.setAttribute("y",m+p/2),w.setAttribute("fill",r.hoverColor),w.setAttribute("text-anchor","middle"),w.textContent=b.toString(),h.appendChild(w)),r.hideLabel||((p=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("x",g+A/2),p.setAttribute("y",m-5),p.setAttribute("text-anchor","middle"),p.textContent=b.toString(),h.appendChild(p))}if(!r.hideAxis){var y=document.createElementNS("http://www.w3.org/2000/svg","g"),v=(y.classList.add("lt-chart-axis"),y.setAttribute("transform","translate(30 30)"),l.appendChild(y),o),t=document.createElementNS("http://www.w3.org/2000/svg","line"),e=(t.setAttribute("x1",0),t.setAttribute("y1",s),t.setAttribute("x2",n),t.setAttribute("y2",s),t.setAttribute("stroke","#787878"),t.setAttribute("stroke-width","1"),y.appendChild(t),document.createElementNS("http://www.w3.org/2000/svg","line"));e.setAttribute("x1",0),e.setAttribute("y1",0),e.setAttribute("x2",0),e.setAttribute("y2",s),e.setAttribute("stroke","#787878"),e.setAttribute("stroke-width","1"),y.appendChild(e);for(let t=0;t<a.length;t++){var S=document.createElementNS("http://www.w3.org/2000/svg","text");S.setAttribute("x",t*(v+r.spacing)+v/2),S.setAttribute("y",s+15),S.setAttribute("text-anchor","middle"),S.textContent=a[t].label,S.setAttribute("fill","#787878"),y.appendChild(S)}for(let t=0;t<=i;t+=Math.round(i/r.axisScaleUnit)){var x=document.createElementNS("http://www.w3.org/2000/svg","text");x.setAttribute("x",-5),x.setAttribute("y",s-t*d),x.setAttribute("text-anchor","end"),x.setAttribute("alignment-baseline","middle"),x.textContent=t.toString(),x.setAttribute("fill","#787878"),y.appendChild(x)}}}}}static#loadChartLine(t){var o=t[0];let d=t[1];var t=t[2],c=document.getElementById(t);if(c){t=document.querySelectorAll('table[data-id="'+o.dataset.id+'"]')[0].querySelectorAll("tbody tr");c.innerHTML="";let s=[];if(t.forEach((t,e)=>{console.log(t.querySelectorAll("td")[d.x]),void 0!==t.querySelectorAll("td")[d.x]&&void 0!==t.querySelectorAll("td")[d.y]&&(t={label:t.querySelectorAll("td")[d.x].textContent,value:t.querySelectorAll("td")[d.y].textContent},s.push(t))}),0==s.length)console.warn("data not found in table!");else{let e=[],a=[];let r=0;s.map(function(t){return e.push(t.label),t.label},this);var o=s.map(function(t){return a.push(t.value),t.value},this),t=e.length,o=Math.max(...o),u=(o>r&&(r=o),r+=5,d.hideAxis?c.clientWidth:c.clientWidth-60);let l=d.hideAxis?c.clientHeight:c.clientHeight-60,i=u/t,n=l/r;if(d.horizintalLines)for(let t=0;t<=r;t+=Math.round(r/d.axisScaleUnit)){var h=document.createElementNS("http://www.w3.org/2000/svg","line");d.hideAxis?h.setAttribute("transform","translate(0 0)"):h.setAttribute("transform","translate(30 30)"),h.setAttribute("x1",0),h.setAttribute("y1",l-t*n),h.setAttribute("x2",u),h.setAttribute("y2",l-t*n),h.setAttribute("stroke",d.horizintalLinesColors),h.setAttribute("stroke-width",0===t?"0":"1"),c.appendChild(h)}var o=document.createElementNS("http://www.w3.org/2000/svg","g"),t=(o.classList.add("lt-chart-visual"),d.hideAxis?o.setAttribute("transform","translate(0 0)"):o.setAttribute("transform","translate(30 30)"),o.setAttribute("width",u),o.setAttribute("height",l),c.appendChild(o),s.map((t,e)=>e*i+","+(l-t.value*n)).join(" ")),b=document.createElementNS("http://www.w3.org/2000/svg","polyline");if(b.setAttribute("points",t),b.setAttribute("fill","none"),b.setAttribute("stroke",d.color),b.setAttribute("stroke-width","2"),o.appendChild(b),console.log(!d.hideAxis),d.hideAxis){t=document.createElementNS("http://www.w3.org/2000/svg","g"),b=(o.classList.add("lt-chart-axis"),d.hideAxis?o.setAttribute("transform","translate(0 0)"):o.setAttribute("transform","translate(30 30)"),c.appendChild(t),document.createElementNS("http://www.w3.org/2000/svg","line")),o=(b.setAttribute("x1",0),b.setAttribute("y1",l),b.setAttribute("x2",u),b.setAttribute("y2",l),b.setAttribute("stroke","#787878"),b.setAttribute("stroke-width","1"),t.appendChild(b),document.createElementNS("http://www.w3.org/2000/svg","line"));o.setAttribute("x1",0),o.setAttribute("y1",0),o.setAttribute("x2",0),o.setAttribute("y2",l),o.setAttribute("stroke","#787878"),o.setAttribute("stroke-width","1"),t.appendChild(o)}else{const A=document.createElementNS("http://www.w3.org/2000/svg","g");A.classList.add("lt-chart-axis"),A.setAttribute("transform","translate(30 30)"),c.appendChild(A);b=document.createElementNS("http://www.w3.org/2000/svg","line"),t=(b.setAttribute("x1",0),b.setAttribute("y1",l),b.setAttribute("x2",u),b.setAttribute("y2",l),b.setAttribute("stroke","#787878"),b.setAttribute("stroke-width","1"),A.appendChild(b),document.createElementNS("http://www.w3.org/2000/svg","line"));t.setAttribute("x1",0),t.setAttribute("y1",0),t.setAttribute("x2",0),t.setAttribute("y2",l),t.setAttribute("stroke","#787878"),t.setAttribute("stroke-width","1"),A.appendChild(t),e.forEach((t,e)=>{var a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttribute("x",e*i),a.setAttribute("y",l+15),a.setAttribute("text-anchor","middle"),a.setAttribute("fill","#787878"),a.textContent=t.toString(),A.appendChild(a)});for(let t=0;t<=r;t+=Math.round(r/d.axisScaleUnit)){var p=document.createElementNS("http://www.w3.org/2000/svg","text");p.setAttribute("x",-5),p.setAttribute("y",l-t*n),p.setAttribute("text-anchor","end"),p.setAttribute("alignment-baseline","middle"),p.setAttribute("fill","#787878"),p.textContent=t.toString(),A.appendChild(p)}}}}}}